<!DOCTYPE html>
<html data-bs-theme="auto">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>{% block title %}Reward{% endblock %}</title>
        {% block stylesheets %}
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous"> 
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        <link href="{{ asset('css/app.css') }}" rel="stylesheet">
        {% endblock %}


        {% block javascripts %}
          <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
          <script defer src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
          <script defer src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
          <script defer src="{{ asset('js/app.js') }}"></script>
        {% endblock %}
    </head>
    <body>  
<div class="container py-4 mb-5">
{% if (selectedchild is not null and selectedchild is not empty) %}
      <div class="d-flex align-items-center gap-3">
        <img src="https://gravatar.com/avatar/{{selectedchild.emailcrypted}}" alt="Photo enfant" class="child-photo">
        <div class="d-flex flex-column w-100">
          <div class="child-name">{{selectedchild.firstname}}</div>
        <div class="progress-container ">
          <div id="pointsText" class="points-text">
            <span id="currentPointText">{{selectedchild.points}}</span>
            points</div>
          <span id="maxPointText">500</span></div>
          <div class="progress">
            <div id="pointsBar" class="progress-bar" role="progressbar" style="width: 0%"></div>
          </div>
        </div>
      </div>
      </div>
    {% endif %}
    </div>
      <div class="clearfix"></div>
      <main class=" align-items-center bg-body-tertiary" aria-live="polite" aria-atomic="true">
        <div class="container">
          <div class="clearfix">&nbsp;</div>
          {# Toasts Bootstrap pour les flashs #}
          <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1080;">
            {% for label, messages in app.flashes %}
              {% for message in messages %}
                <div class="toast align-items-center text-bg-{{ label }} border-0" role="status" aria-live="polite" aria-atomic="true" data-bs-delay="4000">
                  <div class="d-flex">
                    <div class="toast-body">{{ message }}</div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                  </div>
                </div>
              {% endfor %}
            {% endfor %}
          </div>
          {% block body %}{% endblock %}
        </div>
      </main>
      <div class="footer d-flex">
        <a href="{{ path('app_home') }}" class="{% if path == 'app_home' %}active{% endif %}">
          <i class="fa-solid fa-house"></i><br/>Home
        </a>
        <a href="{{ path('app_home_historic') }}" class="{% if path == 'app_home_historic' %}active{% endif %}" >
          <i class="fa-solid fa-clock"></i><br />Historique
        </a>
        <a href="#" data-bs-toggle="modal" data-bs-target="#childModal">
          <i class="fa-solid fa-users"></i><br/>Changer d'enfant
        </a>
        <a href="{{ path('admin') }}">
            <i class="fa-solid fa-gear"></i><br />Administration
        </a>
      </div>
<div class="modal fade" id="childModal" tabindex="-1" aria-labelledby="prenomModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="prenomModalLabel">Changer d'enfant :</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
            </div>
            <div class="modal-body text-center">
              <select id="child-select" class="form-select" style="min-width: 220px;">
                <option value="" disabled {% if selectedchild is null or selectedchild is empty %} selected {% endif %}>Choisir un enfant</option>
                {% for child in children %}
                  <option value="{{ child.id }}" {% if (selectedchild is not null and selectedchild is not empty) and selectedchild.id == child.id %} selected {% endif %}>{{ child }}
                    ({{ child.points }} points)</option>
                {% endfor %}
              </select>
            </div>
          </div>
        </div>
      </div>

    </body>
</html>
